var le=Object.defineProperty;var se=(r,e,t)=>e in r?le(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var D=(r,e,t)=>se(r,typeof e!="symbol"?e+"":e,t);import{s as C,t as I}from"./chunk-LvLJmgfZ.js";import{t as G}from"./react-Bj1aDYRI.js";import{ii as ue}from"./cells-BvQJ_wGv.js";import{t as V}from"./compiler-runtime-B3qBwwSJ.js";import{m as q}from"./useEventListener-B3HCnU20.js";import{t as ce}from"./jsx-runtime-BttUhiRM.js";import{t as B}from"./cn-BfqzeB_k.js";import{t as de}from"./requests-DqPjMMrg.js";import{t as fe}from"./createLucideIcon-C5NDK5NL.js";import{t as j}from"./use-toast-CAzHts2e.js";import{n as me}from"./paths-gUC_uwid.js";import{d as pe}from"./popover-Ds94yD5w.js";import{r as H}from"./errors-CZb6hI2x.js";import{t as W}from"./dist-Cka1pjxF.js";import{t as X}from"./html-to-image-DvPYLUI8.js";var ve=fe("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Y=r=>{let e,t=new Set,a=(l,s)=>{let c=typeof l=="function"?l(e):l;if(!Object.is(c,e)){let d=e;e=s??(typeof c!="object"||!c)?c:Object.assign({},e,c),t.forEach(u=>u(e,d))}},n=()=>e,o={setState:a,getState:n,getInitialState:()=>i,subscribe:l=>(t.add(l),()=>t.delete(l)),destroy:()=>{t.clear()}},i=e=r(a,n,o);return o},he=r=>r?Y(r):Y,ge=I((r=>{var e=G(),t=pe();function a(d,u){return d===u&&(d!==0||1/d==1/u)||d!==d&&u!==u}var n=typeof Object.is=="function"?Object.is:a,o=t.useSyncExternalStore,i=e.useRef,l=e.useEffect,s=e.useMemo,c=e.useDebugValue;r.useSyncExternalStoreWithSelector=function(d,u,f,g,m){var p=i(null);if(p.current===null){var x={hasValue:!1,value:null};p.current=x}else x=p.current;p=s(function(){function M(y){if(!T){if(T=!0,S=y,y=g(y),m!==void 0&&x.hasValue){var N=x.value;if(m(N,y))return $=N}return $=y}if(N=$,n(S,y))return N;var A=g(y);return m!==void 0&&m(N,A)?(S=y,N):(S=y,$=A)}var T=!1,S,$,U=f===void 0?null:f;return[function(){return M(u())},U===null?void 0:function(){return M(U())}]},[u,f,g,m]);var b=o(d,p[0],p[1]);return l(function(){x.hasValue=!0,x.value=b},[b]),c(b),b}})),ye=I(((r,e)=>{e.exports=ge()}));const h={toMarkdown:r=>h.replace(r,"md"),toHTML:r=>h.replace(r,"html"),toPNG:r=>h.replace(r,"png"),toPDF:r=>h.replace(r,"pdf"),toPY:r=>h.replace(r,"py"),withoutExtension:r=>{let e=r.split(".");return e.length===1?r:e.slice(0,-1).join(".")},replace:(r,e)=>r.endsWith(`.${e}`)?r:`${h.withoutExtension(r)}.${e}`};var P=320,L=180;function z(r){if(!r||r==="about:blank")return null;try{let e=new URL(r,window.location.href);return e.origin===window.location.origin?null:e.href}catch{return r}}function we(r,e,t){let a=[],n="";for(let o of e){let i=n+o;r.measureText(i).width<=t?n=i:(n&&a.push(n),n=o)}return n&&a.push(n),a}function k(r){let e=window.devicePixelRatio||1,t=document.createElement("canvas");t.width=P*e,t.height=L*e;let a=t.getContext("2d");if(!a)return t.toDataURL("image/png");a.scale(e,e),a.fillStyle="#f3f4f6",a.fillRect(0,0,P,L),a.strokeStyle="#d1d5db",a.strokeRect(.5,.5,P-1,L-1),a.fillStyle="#6b7280",a.font="8px sans-serif",a.textAlign="center",a.textBaseline="middle";let n=P-32,o=r?we(a,r,n):[],i=(L-(1+o.length)*14)/2+14/2;a.fillText("External iframe",P/2,i),i+=14;for(let l of o)a.fillText(l,P/2,i),i+=14;return t.toDataURL("image/png")}async function xe(r){var n;let e=r.querySelector("iframe");if(!e)return null;let t=z(e.getAttribute("src"));if(t)return k(t);let a;try{let o=e.contentDocument||((n=e.contentWindow)==null?void 0:n.document);if(!(o!=null&&o.body))return null;a=o}catch{return k(null)}for(let o of a.querySelectorAll("iframe")){let i=z(o.getAttribute("src"));if(i)return k(i)}return null}var J=class ie{constructor(e){D(this,"progress",0);D(this,"listeners",new Set);this.total=e}static indeterminate(){return new ie("indeterminate")}addTotal(e){this.total==="indeterminate"?this.total=e:this.total+=e,this.notifyListeners()}increment(e){this.progress+=e,this.notifyListeners()}getProgress(){return this.total==="indeterminate"?"indeterminate":this.progress/this.total*100}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}notifyListeners(){let e=this.getProgress();for(let t of this.listeners)t(e)}},v=C(G(),1),w=C(ce(),1);function be(r,e=[]){let t=[];function a(o,i){let l=v.createContext(i);l.displayName=o+"Context";let s=t.length;t=[...t,i];let c=u=>{var b;let{scope:f,children:g,...m}=u,p=((b=f==null?void 0:f[r])==null?void 0:b[s])||l,x=v.useMemo(()=>m,Object.values(m));return(0,w.jsx)(p.Provider,{value:x,children:g})};c.displayName=o+"Provider";function d(u,f){var p;let g=((p=f==null?void 0:f[r])==null?void 0:p[s])||l,m=v.useContext(g);if(m)return m;if(i!==void 0)return i;throw Error(`\`${u}\` must be used within \`${o}\``)}return[c,d]}let n=()=>{let o=t.map(i=>v.createContext(i));return function(i){let l=(i==null?void 0:i[r])||o;return v.useMemo(()=>({[`__scope${r}`]:{...i,[r]:l}}),[i,l])}};return n.scopeName=r,[a,Ne(n,...e)]}function Ne(...r){let e=r[0];if(r.length===1)return e;let t=()=>{let a=r.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(n){let o=a.reduce((i,{useScope:l,scopeName:s})=>{let c=l(n)[`__scope${s}`];return{...i,...c}},{});return v.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}var O="Progress",_=100,[Pe,at]=be(O),[Se,$e]=Pe(O),K=v.forwardRef((r,e)=>{let{__scopeProgress:t,value:a=null,max:n,getValueLabel:o=je,...i}=r;(n||n===0)&&!te(n)&&console.error(Le(`${n}`,"Progress"));let l=te(n)?n:_;a!==null&&!re(a,l)&&console.error(Ee(`${a}`,"Progress"));let s=re(a,l)?a:null,c=E(s)?o(s,l):void 0;return(0,w.jsx)(Se,{scope:t,value:s,max:l,children:(0,w.jsx)(W.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":E(s)?s:void 0,"aria-valuetext":c,role:"progressbar","data-state":ee(s,l),"data-value":s??void 0,"data-max":l,...i,ref:e})})});K.displayName=O;var Q="ProgressIndicator",Z=v.forwardRef((r,e)=>{let{__scopeProgress:t,...a}=r,n=$e(Q,t);return(0,w.jsx)(W.div,{"data-state":ee(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...a,ref:e})});Z.displayName=Q;function je(r,e){return`${Math.round(r/e*100)}%`}function ee(r,e){return r==null?"indeterminate":r===e?"complete":"loading"}function E(r){return typeof r=="number"}function te(r){return E(r)&&!isNaN(r)&&r>0}function re(r,e){return E(r)&&!isNaN(r)&&r<=e&&r>=0}function Le(r,e){return`Invalid prop \`max\` of value \`${r}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${_}\`.`}function Ee(r,e){return`Invalid prop \`value\` of value \`${r}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${_} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var ne=K,Re=Z,De=V(),F=v.forwardRef((r,e)=>{let t=(0,De.c)(20),a,n,o,i;t[0]===r?(a=t[1],n=t[2],o=t[3],i=t[4]):({className:a,value:i,indeterminate:n,...o}=r,t[0]=r,t[1]=a,t[2]=n,t[3]=o,t[4]=i);let l;t[5]===a?l=t[6]:(l=B("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",a),t[5]=a,t[6]=l);let s=n?"w-1/3 animate-progress-indeterminate":"w-full transition-transform duration-300 ease-out",c;t[7]===s?c=t[8]:(c=B("h-full flex-1 bg-primary",s),t[7]=s,t[8]=c);let d;t[9]!==n||t[10]!==i?(d=n?void 0:{transform:`translateX(-${100-(i||0)}%)`},t[9]=n,t[10]=i,t[11]=d):d=t[11];let u;t[12]!==c||t[13]!==d?(u=(0,w.jsx)(Re,{className:c,style:d}),t[12]=c,t[13]=d,t[14]=u):u=t[14];let f;return t[15]!==o||t[16]!==e||t[17]!==l||t[18]!==u?(f=(0,w.jsx)(ne,{ref:e,className:l,...o,children:u}),t[15]=o,t[16]=e,t[17]=l,t[18]=u,t[19]=f):f=t[19],f});F.displayName=ne.displayName;var ke=V();const Oe=r=>{let e=(0,ke.c)(13),{progress:t,showPercentage:a}=r,n=a===void 0?!1:a,o,i;e[0]===t?(o=e[1],i=e[2]):(o=g=>t.subscribe(g),i=()=>t.getProgress(),e[0]=t,e[1]=o,e[2]=i);let l=(0,v.useSyncExternalStore)(o,i),s=l==="indeterminate"||l===100,c=s?void 0:l,d;e[3]!==s||e[4]!==c?(d=(0,w.jsx)(F,{value:c,indeterminate:s}),e[3]=s,e[4]=c,e[5]=d):d=e[5];let u;e[6]!==s||e[7]!==n||e[8]!==l?(u=!s&&n&&(0,w.jsxs)("div",{className:"mt-1 text-xs text-muted-foreground text-right",children:[Math.round(l),"%"]}),e[6]=s,e[7]=n,e[8]=l,e[9]=u):u=e[9];let f;return e[10]!==d||e[11]!==u?(f=(0,w.jsxs)("div",{className:"mt-2 w-full min-w-[200px]",children:[d,u]}),e[10]=d,e[11]=u,e[12]=f):f=e[12],f};var _e=1200;async function Fe(r,e,t){let a=J.indeterminate(),n=j({title:r,description:v.createElement(Oe,{progress:a}),duration:1/0});try{let o=await e(a);return t?n.update({duration:_e,description:void 0,...t}):n.dismiss(),o}catch(o){throw n.dismiss(),o}}function Me(r){let e=document.getElementById(ue.create(r));if(!e){q.error(`Output element not found for cell ${r}`);return}return e}var Te=500,Ue=`
  * { scrollbar-width: none; -ms-overflow-style: none; }
  *::-webkit-scrollbar { display: none; }
`;async function ae(r){let e=Me(r);if(!e)return;let t=await xe(e);if(t)return t;let a=Date.now(),n=await X(e,{extraStyleContent:Ue,style:{maxHeight:"none",overflow:"visible"},height:e.scrollHeight}),o=Date.now()-a;return o>Te&&q.debug("toPng operation for element",e,`took ${o} ms (exceeds threshold)`),n}async function Ae(r,e){try{let t=await ae(r);if(!t)throw Error("Failed to get image data URL");R(t,h.toPNG(e))}catch(t){j({title:"Failed to download PNG",description:H(t),variant:"danger"})}}const Ce=()=>(document.body.classList.add("printing"),()=>{document.body.classList.remove("printing")});async function Ie(r){let{element:e,filename:t,prepare:a}=r,n=document.getElementById("App"),o=(n==null?void 0:n.scrollTop)??0,i;a&&(i=a(e));try{R(await X(e),h.toPNG(t))}catch{j({title:"Error",description:"Failed to download as PNG.",variant:"danger"})}finally{i==null||i(),document.body.classList.contains("printing")&&document.body.classList.remove("printing"),requestAnimationFrame(()=>{n==null||n.scrollTo(0,o)})}}function R(r,e){let t=document.createElement("a");t.href=r,t.download=e,t.click(),t.remove()}function oe(r,e){let t=URL.createObjectURL(r);R(t,e),URL.revokeObjectURL(t)}async function Ge(r){let e=de(),{filename:t,webpdf:a}=r;try{let n=await e.exportAsPDF({webpdf:a}),o=me.basename(t);oe(n,h.toPDF(o))}catch(n){throw j({title:"Failed to download",description:H(n),variant:"danger"}),n}}export{Ae as a,Fe as c,h as d,ye as f,R as i,F as l,ve as m,Ge as n,Ie as o,he as p,oe as r,ae as s,Ce as t,J as u};
